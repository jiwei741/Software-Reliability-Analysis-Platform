# 软件用户手册

**项目名称：软件可靠性分析平台**  
**版本：V1.0**  
**日期：2025-12-15**  
**编制：研发团队**  
**审核：—**  
**批准：—**

<div style="page-break-after: always;"></div>

## 版本修订记录
| 版本 | 日期 | 作者 | 审核 | 批准 | 变更说明 |
| --- | --- | --- | --- | --- | --- |
| V1.0 | 2025-12-15 | 团队 | — | — | 首次编制，依据当前平台功能撰写 |

## 分发记录
| 分发对象 | 职责 | 日期 | 备注 |
| --- | --- | --- | --- |
| 项目组全体 | 研发/测试/运维 | 2025-12-15 | 内部共享 |
| 业务方代表 | 评审/验收 | 2025-12-15 | 仅供审阅 |

<div style="page-break-after: always;"></div>

## 目录
1. 引言  
&emsp;1.1 目的  
&emsp;1.2 适用范围  
&emsp;1.3 参考资料  
2. 产品概述  
&emsp;2.1 平台简介  
&emsp;2.2 用户特征与角色  
&emsp;2.3 运行环境与依赖  
3. 安装与部署  
&emsp;3.1 软件获取  
&emsp;3.2 环境准备  
&emsp;3.3 安装/启动/停止  
&emsp;3.4 配置文件说明  
4. 登录与导航  
5. 功能使用说明  
&emsp;5.1 数据导入（手动/文件/MySQL/DeepSeek 映射）  
&emsp;5.2 经典可靠性模型  
&emsp;5.3 人工智能模型  
&emsp;5.4 时间序列模型  
&emsp;5.5 组合加权与 SDA  
&emsp;5.6 模型对比分析  
&emsp;5.7 系统管理（Cloudflare Worker 用户管理）  
&emsp;5.8 文档与导出  
6. 常见问题与排障  
7. 数据、安全与权限  
8. 附录：接口与路径

<div style="page-break-after: always;"></div>

## 1 引言
### 1.1 目的
为平台使用者提供安装、配置、操作和故障排查指南，确保数据导入、模型分析、报表导出等功能可顺利使用。

### 1.2 适用范围
- 用户：研发、测试、运维、业务分析人员。  
- 部署：本地或内网环境；如需外网访问请自行加固网络与鉴权。

### 1.3 参考资料
- `.env.example`（环境示例）  
- `docs/requirements.md`（需求文档）  
- `docs/test-report.md`（测试报告）  
- `用户管理流程.md`（Worker 用户操作）

## 2 产品概述
### 2.1 平台简介
平台支持多源数据导入（手动、CSV/Excel、MySQL、DeepSeek 智能列映射），内置经典可靠性模型、轻量 AI 模型、时间序列预测、组合加权与 SDA 场景分析，可视化呈现并支持导出 HTML/PDF。

### 2.2 用户特征与角色
- 普通用户：导入数据、查看图表、导出报告。  
- 分析人员：配置列映射、触发模型分析、查看误差指标/公式。  
- 管理员：维护用户（Cloudflare Worker）、配置外部 API/数据库、查看日志。

### 2.3 运行环境与依赖
- Python 3.9+（本地 Anaconda 环境已验证）。  
- 主要依赖：Flask；如需表格解析/Excel/MySQL，安装 `pandas`、`openpyxl`、`mysql-connector-python`。  
- 前端：模板 `templates/`，静态资源 `assets/`，图表使用 Chart.js，公式使用 MathJax。

## 3 安装与部署
### 3.1 软件获取
将项目代码放置于 `D:\软件可靠性分析平台`（或任意路径，注意 `.env` 与代码同级）。

### 3.2 环境准备
```bash
pip install -r requirements.txt
```
若需 Excel/MySQL 支持，请确认已安装 `openpyxl`、`mysql-connector-python`。

### 3.3 安装/启动/停止
1) 激活 Python 环境并安装依赖。  
2) 启动服务（默认 5000 端口）：  
   ```bash
   python app.py
   # 访问 http://127.0.0.1:5000
   ```  
3) 停止：命令行 Ctrl+C。  
4) 日志：控制台实时输出；如需文件日志，可在 `app.py` 中追加日志配置。

### 3.4 配置文件说明
`.env` 关键字段：  
- `DEEPSEEK_API_KEY`：启用 DeepSeek 智能列映射。  
- `MYSQL_DSN`：如 `mysql://user:pass@host:3306/database`。  
- `WORKER_ENDPOINT`、`WORKER_AUTH_TOKEN`：Cloudflare Worker 用户管理接口（可选）。  
参考 `.env.example` 填写。

## 4 登录与导航
- 左侧导航：数据导入、经典模型、人工智能模型、时间序列、组合加权/SDA、模型对比、系统管理、需求文档。  
- 数据导入成功后仪表盘会自动刷新；各分析板块需点击“开始分析”按需加载，避免一次性渲染全部图表。  
- 数据导入页：文件/MySQL 预览后会弹出列映射/DeepSeek 分析窗口，确认后再写入主数据。

## 5 功能使用说明
### 5.1 数据导入（手动/文件/MySQL/DeepSeek 映射）
- 手动导入：填写模块/失效/MTBF/运行时长，提交后写入并刷新仪表盘。  
- 文件导入（CSV/Excel）：  
  1) “上传并获取样本”预览前几行；  
  2) 选择“本地映射”或“DeepSeek 分析”完成列映射（模块/失效/MTBF/时长）；  
  3) 确认应用映射后导入。  
- MySQL 导入：填写 DSN、表名、增量字段、限制条数；先“预览样本”，再映射或 DeepSeek 分析后确认导入。  
- DeepSeek 映射：需配置 `DEEPSEEK_API_KEY`；调用失败自动回退本地映射。  
- 数据字段示例：  

| 列名示例 | 含义 | 备注 |
| --- | --- | --- |
| module | 模块/子系统名称 | 字符串 |
| failures | 失效次数 | 非负整数 |
| mtbf | 平均无故障时间 | 数值 |
| runtime | 运行时长 | 数值；缺省可等于 mtbf |

### 5.2 经典可靠性模型
- 模型：Goel-Okumoto、Jelinski-Moranda、Musa-Okumoto、Crow-AMSAA、Duane。  
- 操作：导入数据后点击“开始分析”，计算参数并生成累计失效/强度/增长/MTBF 曲线，公式由 MathJax 渲染。  
- 输出：图表 + 模型参数（如 a/b、phi、lambda/beta 等）+ 关键公式展示。

### 5.3 人工智能模型
- 模型：BPN、RBF、线性 SVM、GEP（轻量训练）。  
- 数据：使用 failures/runtime 为特征，mtbf 为标签；样本不足时自动降级为基线。  
- 输出：预测 vs 实际、RMSE、权重/中心/多项式系数等，需点击“开始分析”触发。

### 5.4 时间序列模型
ARIMA 近似、Holt-Winters 三指数平滑，基于导入数据生成短期预测与平滑序列；需点击“开始分析”触发。

### 5.5 组合加权与 SDA
- 组合加权：动态平衡经典与 AI 输出，显示静态/动态权重曲线。  
- SDA：路径可靠度近似，展示场景可靠度估计与路径权重。

### 5.6 模型对比分析
对比 PKR/性能等指标，按需加载，避免一次性渲染全部。

### 5.7 系统管理（Cloudflare Worker 用户管理）
- 添加用户：填写姓名/角色/邮箱/状态，提交后由后端直接 POST 至 `WORKER_ENDPOINT`。  
- 列表：右侧实时拉取 KV 中已存用户。  
- 删除：当前需命令或 API 方式 `DELETE /users/<id>`（参见 `用户管理流程.md`）；如 Worker 需鉴权，请在 `.env` 配置 `WORKER_AUTH_TOKEN`。

### 5.8 文档与导出
- “需求文档”入口：打开 `docs/requirements.md` 或外链。  
- 报表导出：前端一键导出分析结果为 HTML，建议在浏览器确认公式渲染后再打印为 PDF 以保留目录跳转。

## 6 常见问题与排障
- PDF 内部跳转：先用浏览器打开导出的 HTML，确认目录可跳转，再打印为 PDF；或用 `wkhtmltopdf --enable-internal-links`。  
- DeepSeek 失败/超时：检查 `DEEPSEEK_API_KEY`、网络；失败时会自动回退本地映射。  
- MySQL 导入无响应：核对 DSN/表名/权限，确保 `mysql-connector-python` 已安装，查看 `app.py` 控制台日志。  
- NaN/溢出或 JSON 报错：数据存在极端值时 RMSE 可能溢出，已加裁剪；如仍异常，请清洗数据或减少数值量级。  
- 公式未渲染：导出 HTML 时增加 `--mathjax`，或确保前端已加载 MathJax。  
- 上传无反应：确认文件格式为 CSV/Excel，列至少包含模块/失效/MTBF；预览成功后再点击“应用映射”。

## 7 数据、安全与权限
- 数据默认保存在内存/本地，未自动持久化到数据库；敏感数据请自行加密存储。  
- `.env` 仅保存在服务器，避免硬编码密钥到代码库；示例放在 `.env.example`。  
- Worker 接口如启用鉴权，需配置 `WORKER_AUTH_TOKEN` 并在调用时附带；对外网暴露端口需自备防火墙与访问控制。  
- 日志与数据导出请避免包含敏感信息再对外共享。

## 8 附录：接口与路径
- 后端入口：`app.py`  
- 数据接口：`/api/import/file`、`/api/import/mysql`、`/api/deepseek/mapping`、`/api/analyze/<section>`  
- 用户接口：`/api/users`（前端拉取）；Worker：`POST/GET/DELETE https://<worker>/users`  
- 目录参考：  
  - 模型逻辑：`services/reliability.py`  
  - DeepSeek 适配：`services/deepseek.py`  
  - 前端逻辑：`templates/index.html`、`assets/js/app.js`
